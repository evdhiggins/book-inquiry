<div class="search-page">
	<div class="searchbar-container">
		<SearchBar on:search="performSearch(event.searchValue)" />
	</div>
	<div class="results-container">
		{#each items as item}
		<SearchItem {item} /> {/each}
	</div>
</div>

<script>
  export default {
    components: {
      SearchBar: "../components/SearchBar.html",
      SearchItem: "../components/SearchItem.html"
    },
    data() {
      return {
        items: []
      };
    },
    methods: {
      async performSearch(searchValue) {
        try {
          const encodedSearchString = encodeURI(searchValue);
          const requestUrl = `http://localhost:5000/book-inquiry/us-central1/api/search?q=${encodedSearchString}`;
          const response = await fetch(requestUrl);
          if (!response.ok) {
            throw new Error(response.statusText);
          }
          const { items } = await response.json();
          this.set({ items });
        } catch (err) {
          alert(err);
        }
      }
    }
  };
</script>

<style>
  .search-page {
    width: 60%;
    margin-left: 20%;
  }

  .searchbar-container {
    display: flex;
    justify-content: center;
    width: 100%;
  }

  .results-container {
    display: flex;
    flex-direction: column;
  }

  @media (max-width: 1000px) {
    .search-page {
      width: 80%;
      margin-left: 10%;
    }
  }

  @media (max-width: 600px) {
    .search-page {
      width: 100%;
      margin-left: 0%;
    }
  }
</style>